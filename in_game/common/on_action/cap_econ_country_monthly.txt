monthly_country_pulse = {
    on_actions = {
        monthly_country_pulse_capecon
        monthly_country_pulse_capecon_2
    }
    events = {
        estate_income_fix.1
        estate_income_fix.3
    }
}

monthly_country_pulse_capecon = {
    trigger = {
        receiving_scripted_relation_of_type = relation_type:cap_econ_send_pantalone
    }

    random_events = {
        25 = cap_econ.1
        15 = cap_econ.2
        40 = cap_econ.25
        5 = cap_econ.5
        5 = cap_econ.6
        1 = cap_econ.7
        1 = cap_econ.8
        1 = cap_econ.9
        chance_to_happen = 80
    }
  effect = {
      if = {
          limit = { religion = religion:pantalonism }
          every_country = {
              limit = {
                  giving_scripted_relation = {
                      type = relation_type:cap_econ_send_pantalone
                      target = root
                  }
              }
              remove_relation = {
                  type = relation_type:cap_econ_send_pantalone
                  first = this
                  second = root
              }
          }
      }
  }

}


yearly_country_pulse = {
    events = {
        estate_income_fix.2
    }
    on_actions = {
        yearly_country_pulse_capecon_io
    }
}

monthly_country_pulse_capecon_2 = {
    trigger = {
        AND = {
            tag = BLG
            NOT = { religion = religion:pantalonism }
            NOT = { is_situation_active = situation:rise_of_pantalonism }

        }

    }
    events = {
        cap_econ.22
    }
    effect = {
        add_gold = 1000
        set_variable = { name = cap_start_pantalone value = 1 }

    }

}

yearly_country_pulse_capecon_io = {
    trigger = {
        religion = religion:pantalonism
        NOT = { is_member_of_international_organization = international_organization:cap_econ_pantalonist_io }
    }
    effect = {
        if = {
            limit = { NOT = { exists = international_organization:cap_econ_pantalonist_io } }
            create_international_organization = {
                type = international_organization_type:cap_econ_pantalonist_io
                hidden_effect = {
                    add_country_to_international_organization = prev
                    if = {
                        limit = { exists = c:BLG c:BLG = { religion = religion:pantalonism } }
                        set_leader_country = c:BLG
                    }
                    else = { set_leader_country = prev }
                }
            }
        }
        else = {
            if = {
                limit = {
                    NOT = {
                        is_member_of_international_organization = international_organization:cap_econ_pantalonist_io
                    }
                }
                international_organization:cap_econ_pantalonist_io = {
                    add_country_to_international_organization_no_update = prev
                    if = {
                        limit = { international_organization_has_leader = no }
                        if = {
                            limit = { exists = c:BLG c:BLG = { religion = religion:pantalonism } }
                            set_leader_country = c:BLG
                        }
                        else = { set_leader_country = prev }
                    }
                }
            }
        }
    }
}
