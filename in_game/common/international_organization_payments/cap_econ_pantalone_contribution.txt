pantalone_contribution = {
	get_payer_list = {
		if = {
			limit = {
				international_organization_has_policy = policy:pantalone_leader_pays_policy
			}
			every_international_organization_member = {
				add_to_local_variable_list = {
					name = payers
					target = this
				}
				every_estate = {
					add_to_local_variable_list = {
						name = payers
						target = this
					}
				}
			}
		}
		else = {
			every_international_organization_member = {
				limit = {
					NOT = { is_leader_of_international_organization = root }
				}
				add_to_local_variable_list = {
					name = payers
					target = this
				}
				every_estate = {
					add_to_local_variable_list = {
						name = payers
						target = this
					}
				}
			}
		}
	}
	get_payee_list = {
		if = {
			limit = {
				international_organization_has_policy = policy:pantalone_dividends_equal_policy
			}
			every_international_organization_member = {
				add_to_local_variable_list = {
					name = payees
					target = this
				}
			}
		}
		else_if = {
			limit = {
				international_organization_has_policy = policy:pantalone_dividends_split_policy
			}
			leader_country ?= {
				add_to_local_variable_list = {
					name = payees
					target = this
				}
			}
			every_international_organization_member = {
				add_to_local_variable_list = {
					name = payees
					target = this
				}
			}
		}
		else = {
			leader_country ?= {
				add_to_local_variable_list = {
					name = payees
					target = this
				}
			}
		}
	}
	price = pantalone_contribution_price
	uses_maintenance = yes
	min_slider_value = 0.05


	price_multiplier = {
		add = {
			desc = "game_concept_monthly_income_trade_and_tax"
			if = {
				limit = {
					international_organization_has_policy = policy:pantalone_leader_pays_policy
				}
				every_international_organization_member = {
					limit = { monthly_balance > 0 }
					add = monthly_balance
				}
			}
			else = {
				every_international_organization_member = {
					limit = {
						NOT = { is_leader_of_international_organization = root }
						monthly_balance > 0
					}
					add = monthly_balance
				}
			}
			multiply = var:contribution_modifier
			multiply = 0.01
		}
		add = {
			desc = "pantalone_contribution_estates"
			if = {
				limit = {
					international_organization_has_policy = policy:pantalone_leader_pays_policy
				}
				every_international_organization_member = {
					add = {
						every_estate = {
							add = estate_taxable_income
						}
					}
				}
			}
			else = {
				every_international_organization_member = {
					limit = {
						NOT = { is_leader_of_international_organization = root }
					}
					add = {
						every_estate = {
							add = estate_taxable_income
						}
					}
				}
			}
			multiply = var:estate_contribution_modifier
			multiply = 0.01
		}
	}
	proportion_for_payer = {
		if = {
			limit = { exists = owner }
			add = {
				desc = "pantalone_contribution_estates"
				value = estate_taxable_income
			}
			multiply = {
				value = scope:recipient.var:estate_contribution_modifier
				multiply = 0.01
			}
		}
		else = {
			if = {
				limit = { monthly_balance > 0 }
				add = {
					desc = "game_concept_monthly_income_trade_and_tax"
					value = monthly_balance
				}
				multiply = {
					value = scope:recipient.var:contribution_modifier
					multiply = 0.01
				}
			}
		}
	}
	proportion_for_payee = {
		if = {
			limit = {
				scope:recipient = {
					international_organization_has_policy = policy:pantalone_dividends_split_policy
				}
			}
			if = {
				limit = {
					root = { is_leader_of_international_organization = scope:recipient }
				}
				add = {
					desc = "pantalone_contribution"
					value = scope:recipient.total_members
				}
			}
			else = {
				add = {
					desc = "pantalone_contribution"
					value = 1
				}
			}
		}
		else = {
			add = {
				desc = "pantalone_contribution"
				value = 1
			}
		}

	}

}
